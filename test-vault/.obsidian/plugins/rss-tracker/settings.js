import { __awaiter } from "tslib";
export const DEFAULT_SETTINGS = {
    autoUpdateFeeds: false,
    rssHome: "RSS",
    rssFeedFolderName: "Feeds",
    rssCollectionsFolderName: "Collections",
    rssTopicsFolderName: "Topics",
    rssTemplateFolder: "Templates",
    rssDashboardName: "RSS Dashboard",
    rssTagmapName: "RSS Tagmap",
    rssDefaultImage: "",
    defaultItemLimit: 100,
};
/**
 * List of basenames of templates to be installed into the `Templates` folder.
 */
const TEMPLATES = ["RSS Feed", "RSS Item", "RSS Topic", "RSS Collection"];
export class RSSTrackerSettings {
    constructor(app, plugin) {
        /**
         * The persisted settings settings
         */
        this._data = Object.assign({}, DEFAULT_SETTINGS);
        this.app = app;
        this.plugin = plugin;
    }
    get _filemgr() {
        return this.plugin.filemgr;
    }
    ;
    static getTemplateFilename(templateName) {
        return templateName + ".md";
    }
    get autoUpdateFeeds() {
        return this._data.autoUpdateFeeds;
    }
    set autoUpdateFeeds(value) {
        this._data.autoUpdateFeeds = value;
    }
    get rssHome() {
        var _a;
        return (_a = this._data.rssHome) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.rssHome;
    }
    set rssHome(value) {
        this._rssHome = value;
    }
    get rssFeedFolderName() {
        var _a;
        return (_a = this._data.rssFeedFolderName) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.rssFeedFolderName;
    }
    set rssFeedFolderName(value) {
        this._rssFeedFolder = value;
    }
    get rssCollectionsFolderName() {
        var _a;
        return (_a = this._data.rssCollectionsFolderName) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.rssCollectionsFolderName;
    }
    set rssCollectionsFolderName(value) {
        this._rssCollectionsFolder = value;
    }
    get rssTopicsFolderName() {
        var _a;
        return (_a = this._data.rssTopicsFolderName) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.rssTopicsFolderName;
    }
    set rssTopicsFolderName(value) {
        this._rssCollectionsFolder = value;
    }
    get rssTemplateFolder() {
        var _a;
        return (_a = this._data.rssTemplateFolder) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.rssTemplateFolder;
    }
    set rssTemplateFolder(value) {
        this._rssTemplateFolder = value;
    }
    get rssDashboardName() {
        return this._data.rssDashboardName || DEFAULT_SETTINGS.rssDashboardName;
    }
    set rssDashboardName(value) {
        this._rssDashboardName = value;
    }
    get rssTagmapName() {
        return this._data.rssTagmapName || DEFAULT_SETTINGS.rssTagmapName;
    }
    set rssTagmapName(value) {
        this._rssTagmapName = value;
    }
    get defaultItemLimit() {
        var _a;
        return (_a = this._data.defaultItemLimit) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.defaultItemLimit;
    }
    set defaultItemLimit(value) {
        this._defaultItemLimit = value;
    }
    /**
     * Get the path to the RSS default image
     */
    get rssDefaultImage() {
        if (this._data.rssDefaultImage && this.app.vault.getFileByPath(this._data.rssDefaultImage)) {
            return this._data.rssDefaultImage;
        }
        return "";
    }
    getRssDefaultImagePath() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.rssDefaultImage) {
                const imagePath = yield this.app.fileManager.getAvailablePathForAttachment("RSSdefaultImage.svg", this.rssDashboardPath), img = yield this.app.vault.create(imagePath, RSSTrackerSettings.RSS_DEFAULT_IMAGE);
                this._data.rssDefaultImage = img.path;
                yield this.saveData();
            }
            return this._data.rssDefaultImage;
        });
    }
    commit() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log("Commiting changes in settings");
            if (this._rssHome && this._rssHome !== this.rssHome) {
                if (yield this._filemgr.renameFolder(this.rssHome, this._rssHome)) {
                    this._data.rssHome = this._rssHome;
                }
                this._rssHome = undefined;
            }
            if (this._rssFeedFolder && this._rssFeedFolder !== this.rssFeedFolderName) {
                if (yield this._filemgr.renameFolder(this.rssFeedFolderPath, this.rssHome + "/" + this._rssFeedFolder)) {
                    this._data.rssFeedFolderName = this._rssFeedFolder;
                }
                this._rssFeedFolder = undefined;
            }
            if (this._rssCollectionsFolder && this._rssCollectionsFolder !== this.rssCollectionsFolderName) {
                if (yield this._filemgr.renameFolder(this.rssCollectionsFolderPath, this.rssHome + "/" + this._rssCollectionsFolder)) {
                    this._data.rssCollectionsFolderName = this._rssCollectionsFolder;
                }
                this._rssCollectionsFolder = undefined;
            }
            if (this._rssTopicsFolder && this._rssTopicsFolder !== this.rssTopicsFolderName) {
                if (yield this._filemgr.renameFolder(this.rssTopicsFolderPath, this.rssHome + "/" + this._rssTopicsFolder)) {
                    this._data.rssTopicsFolderName = this._rssTopicsFolder;
                }
                this._rssTopicsFolder = undefined;
            }
            if (this._rssTemplateFolder && this._rssTemplateFolder !== this.rssTemplateFolder) {
                if (yield this._filemgr.renameFolder(this.rssTemplateFolderPath, this.rssHome + "/" + this._rssTemplateFolder)) {
                    this._data.rssTemplateFolder = this._rssTemplateFolder;
                }
                this._rssTemplateFolder = undefined;
            }
            if (this._rssDashboardName && this._rssDashboardName !== this.rssDashboardName) {
                if (yield this._filemgr.renameFile(this.rssTemplateFolderPath, this.rssHome + "/" + this._rssTemplateFolder)) {
                    this._data.rssDashboardName = this._rssDashboardName;
                }
                this._rssDashboardName = undefined;
            }
            if (this._rssTagmapName && this._rssTagmapName !== this.rssTagmapName) {
                if (yield this._filemgr.renameFile(this.rssTemplateFolderPath, this.rssHome + "/" + this._rssTemplateFolder)) {
                    this._data._rssTagmapName = this._rssTagmapName;
                }
                this._rssDashboardName = undefined;
            }
            if (this._defaultItemLimit && this._defaultItemLimit !== this.defaultItemLimit) {
                this._data.defaultItemLimit = this._defaultItemLimit;
                this._defaultItemLimit = undefined;
            }
            yield this.saveData();
            this.install(); // always assure integrity after commit
        });
    }
    loadData() {
        return __awaiter(this, void 0, void 0, function* () {
            const data = yield this.plugin.loadData();
            if (data) {
                for (const propertyName in this._data) {
                    if (propertyName in data) {
                        this._data[propertyName] = data[propertyName];
                    }
                }
            }
            else {
                console.log("rss-tracker first time load");
                yield this.install(); // first time install
            }
        });
    }
    saveData() {
        return __awaiter(this, void 0, void 0, function* () {
            return this.plugin.saveData(this._data);
        });
    }
    install() {
        return __awaiter(this, void 0, void 0, function* () {
            const vault = this.app.vault, fs = vault.adapter;
            // create folders
            for (const folderPath of [
                this.rssHome,
                this.rssTemplateFolderPath,
                this.rssFeedFolderPath,
                this.rssCollectionsFolderPath,
                this.rssTopicsFolderPath,
            ]) {
                if (!(yield fs.exists(folderPath))) {
                    yield vault.createFolder(folderPath);
                }
            }
            // install factory templates if necessary
            for (const tpl of TEMPLATES) {
                const tplPath = this.getTemplatePath(tpl);
                if (!(yield fs.exists(tplPath))) {
                    const factoryPath = this.plugin.manifest.dir + "/Templates/" + RSSTrackerSettings.getTemplateFilename(tpl);
                    fs.copy(factoryPath, tplPath);
                }
            }
            // the RSS dashboard is a special case
            const dashboardPath = this.rssDashboardPath;
            if (!(yield fs.exists(dashboardPath))) {
                const factoryPath = this.plugin.manifest.dir + "/Templates/" + RSSTrackerSettings.getTemplateFilename("RSS Dashboard");
                fs.copy(factoryPath, dashboardPath);
            }
            // the RSS tag map is a special case too
            const tagmapPath = this.rssTagmapPath;
            if (!(yield fs.exists(tagmapPath))) {
                const factoryPath = this.plugin.manifest.dir + "/Templates/" + RSSTrackerSettings.getTemplateFilename("RSS Tagmap");
                fs.copy(factoryPath, tagmapPath);
            }
            console.log(`RSS directory structure created/updated at '${this.rssHome}'.`);
        });
    }
    get rssFeedFolderPath() {
        return this.rssHome + "/" + this.rssFeedFolderName;
    }
    get rssCollectionsFolderPath() {
        return this.rssHome + "/" + this.rssCollectionsFolderName;
    }
    get rssTopicsFolderPath() {
        return this.rssHome + "/" + this.rssTopicsFolderName;
    }
    get rssTemplateFolderPath() {
        return this.rssHome + "/" + this.rssTemplateFolder;
    }
    get rssDashboardPath() {
        return this.rssHome + "/" + this.rssDashboardName + ".md";
    }
    get rssTagmapPath() {
        return this.rssHome + "/" + this.rssTagmapName + ".md";
    }
    getTemplatePath(templateName) {
        return this.rssTemplateFolderPath + "/" + RSSTrackerSettings.getTemplateFilename(templateName);
    }
}
RSSTrackerSettings.RSS_DEFAULT_IMAGE = '<svg height="300px" width="300px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 398.668 398.668" xml:space="preserve"> <g> <g> <path style="fill:none;" d="M98.107,275.498c-13.789,0-25.006,11.264-25.006,25.107c0,13.777,11.217,24.986,25.006,24.986 c13.834,0,25.09-11.209,25.09-24.986C123.197,286.762,111.941,275.498,98.107,275.498z"/> <path style="fill:none;" d="M360.057,24H38.613C30.555,24,24,30.557,24,38.613v321.443c0,8.057,6.555,14.611,14.613,14.611 h321.443c8.057,0,14.611-6.555,14.611-14.611V38.613C374.668,30.557,368.113,24,360.057,24z M98.107,349.592 c-27.021,0-49.006-21.975-49.006-48.986c0-27.078,21.984-49.107,49.006-49.107c27.068,0,49.09,22.029,49.09,49.107 C147.197,327.617,125.176,349.592,98.107,349.592z M242.715,347.516c0,0-0.008,0.002-0.016,0h-48.729 c-6.541,0-11.877-5.238-11.998-11.777c-0.584-31.625-13.164-61.316-35.424-83.604c-22.275-22.338-51.846-34.953-83.27-35.527 c-6.541-0.119-11.781-5.457-11.781-11.998v-48.582c0-3.211,1.287-6.287,3.572-8.543c2.248-2.217,5.275-3.457,8.428-3.457 c0.055,0,0.107,0,0.162,0c50.654,0.686,98.338,20.883,134.271,56.873c35.758,35.814,55.896,83.281,56.756,133.732 c0.021,0.291,0.031,0.586,0.031,0.883C254.719,342.143,249.348,347.516,242.715,347.516z M337.582,347.516 c0,0-0.008,0.002-0.016,0h-48.648c-6.578,0-11.93-5.295-12-11.871c-1.254-116.738-97.008-212.74-213.451-214.002 c-6.576-0.072-11.871-5.424-11.871-12V61.078c0-3.201,1.279-6.269,3.553-8.521c2.273-2.254,5.367-3.512,8.555-3.477 c75.951,0.68,147.441,30.768,201.303,84.723c53.689,53.779,83.699,125.096,84.553,200.891c0.02,0.272,0.029,0.547,0.029,0.822 C349.588,342.143,344.215,347.516,337.582,347.516z"/> <path style="fill:#3D6889;" d="M98.107,251.498c-27.021,0-49.006,22.029-49.006,49.107c0,27.012,21.984,48.986,49.006,48.986 c27.068,0,49.09-21.975,49.09-48.986C147.197,273.527,125.176,251.498,98.107,251.498z M98.107,325.592 c-13.789,0-25.006-11.209-25.006-24.986c0-13.844,11.217-25.107,25.006-25.107c13.834,0,25.09,11.264,25.09,25.107 C123.197,314.383,111.941,325.592,98.107,325.592z"/> <path style="fill:#73D0F4;" d="M75.498,168.633v24.668c33.244,3.301,64.15,17.926,88.037,41.881 c23.879,23.906,38.459,54.922,41.746,88.334h24.816C223.066,241.893,156.986,175.689,75.498,168.633z"/> <path style="fill:#3D6889;" d="M197.932,200.9c-35.934-35.99-83.617-56.188-134.271-56.873c-0.055,0-0.107,0-0.162,0 c-3.152,0-6.18,1.24-8.428,3.457c-2.285,2.256-3.572,5.332-3.572,8.543v48.582c0,6.541,5.24,11.879,11.781,11.998 c31.424,0.574,60.994,13.189,83.27,35.527c22.26,22.287,34.84,51.979,35.424,83.604c0.121,6.539,5.457,11.777,11.998,11.777 h48.729c0.008,0.002,0.016,0,0.016,0c6.633,0,12.004-5.373,12.004-12c0-0.297-0.01-0.592-0.031-0.883 C253.828,284.182,233.689,236.715,197.932,200.9z M205.281,323.516c-3.287-33.412-17.867-64.428-41.746-88.334 c-23.887-23.955-54.793-38.58-88.037-41.881v-24.668c81.488,7.057,147.568,73.26,154.6,154.883H205.281z"/> <path style="fill:#73D0F4;" d="M75.596,73.465v24.598c58.516,3.502,113.188,28.121,155.029,70.064 c41.838,41.943,66.391,96.742,69.877,155.389h24.682C317.852,189.59,209.293,80.834,75.596,73.465z"/> <path style="fill:#3D6889;" d="M265.006,133.803C211.145,79.848,139.654,49.76,63.703,49.08c-3.188-0.035-6.281,1.223-8.555,3.477 c-2.273,2.252-3.553,5.32-3.553,8.521v48.565c0,6.576,5.295,11.928,11.871,12c116.443,1.262,212.197,97.264,213.451,214.002 c0.07,6.576,5.422,11.871,12,11.871h48.648c0.008,0.002,0.016,0,0.016,0c6.633,0,12.006-5.373,12.006-12 c0-0.275-0.01-0.551-0.029-0.822C348.705,258.898,318.695,187.582,265.006,133.803z M300.502,323.516 c-3.486-58.646-28.039-113.445-69.877-155.389c-41.842-41.943-96.514-66.563-155.029-70.064V73.465 c133.697,7.369,242.256,116.125,249.588,250.051H300.502z"/> <path style="fill:#3D6889;" d="M360.057,0H38.613C17.322,0,0,17.322,0,38.613v321.443c0,21.291,17.322,38.611,38.613,38.611 h321.443c21.291,0,38.611-17.32,38.611-38.611V38.613C398.668,17.322,381.348,0,360.057,0z M374.668,360.057 c0,8.057-6.555,14.611-14.611,14.611H38.613c-8.059,0-14.613-6.555-14.613-14.611V38.613C24,30.557,30.555,24,38.613,24h321.443 c8.057,0,14.611,6.557,14.611,14.613V360.057z"/> </g> </g> </svg>';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZ3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvc2V0dGluZ3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQW1CQSxNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBd0I7SUFDcEQsZUFBZSxFQUFFLEtBQUs7SUFDdEIsT0FBTyxFQUFFLEtBQUs7SUFDZCxpQkFBaUIsRUFBRSxPQUFPO0lBQzFCLHdCQUF3QixFQUFFLGFBQWE7SUFDdkMsbUJBQW1CLEVBQUUsUUFBUTtJQUM3QixpQkFBaUIsRUFBRSxXQUFXO0lBQzlCLGdCQUFnQixFQUFFLGVBQWU7SUFDakMsYUFBYSxFQUFFLFlBQVk7SUFDM0IsZUFBZSxFQUFFLEVBQUU7SUFDbkIsZ0JBQWdCLEVBQUUsR0FBRztDQUNyQixDQUFBO0FBT0Q7O0dBRUc7QUFDSCxNQUFNLFNBQVMsR0FBb0IsQ0FBQyxVQUFVLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO0FBRTNGLE1BQU0sT0FBTyxrQkFBa0I7SUF5TDlCLFlBQVksR0FBUSxFQUFFLE1BQXdCO1FBNUs5Qzs7V0FFRztRQUNLLFVBQUsscUJBQTZCLGdCQUFnQixFQUFHO1FBMEs1RCxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztRQUNmLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0lBQ3RCLENBQUM7SUF2TEQsSUFBWSxRQUFRO1FBQ25CLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUM7SUFDNUIsQ0FBQztJQUFBLENBQUM7SUFFRixNQUFNLENBQUMsbUJBQW1CLENBQUMsWUFBMkI7UUFDckQsT0FBTyxZQUFZLEdBQUcsS0FBSyxDQUFDO0lBQzdCLENBQUM7SUFPRCxJQUFJLGVBQWU7UUFDbEIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQztJQUNuQyxDQUFDO0lBRUQsSUFBSSxlQUFlLENBQUMsS0FBYztRQUNqQyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7SUFDcEMsQ0FBQztJQVdELElBQUksT0FBTzs7UUFDVixPQUFPLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLG1DQUFJLGdCQUFnQixDQUFDLE9BQU8sQ0FBQztJQUN2RCxDQUFDO0lBRUQsSUFBSSxPQUFPLENBQUMsS0FBYTtRQUN4QixJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztJQUN2QixDQUFDO0lBRUQsSUFBSSxpQkFBaUI7O1FBQ3BCLE9BQU8sTUFBQSxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixtQ0FBSSxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQztJQUMzRSxDQUFDO0lBRUQsSUFBSSxpQkFBaUIsQ0FBQyxLQUFhO1FBQ2xDLElBQUksQ0FBQyxjQUFjLEdBQUcsS0FBSyxDQUFDO0lBQzdCLENBQUM7SUFFRCxJQUFJLHdCQUF3Qjs7UUFDM0IsT0FBTyxNQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsd0JBQXdCLG1DQUFJLGdCQUFnQixDQUFDLHdCQUF3QixDQUFDO0lBQ3pGLENBQUM7SUFFRCxJQUFJLHdCQUF3QixDQUFDLEtBQWE7UUFDekMsSUFBSSxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQztJQUNwQyxDQUFDO0lBRUQsSUFBSSxtQkFBbUI7O1FBQ3RCLE9BQU8sTUFBQSxJQUFJLENBQUMsS0FBSyxDQUFDLG1CQUFtQixtQ0FBSSxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQztJQUMvRSxDQUFDO0lBRUQsSUFBSSxtQkFBbUIsQ0FBQyxLQUFhO1FBQ3BDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxLQUFLLENBQUM7SUFDcEMsQ0FBQztJQUVELElBQUksaUJBQWlCOztRQUNwQixPQUFPLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsbUNBQUksZ0JBQWdCLENBQUMsaUJBQWlCLENBQUM7SUFDM0UsQ0FBQztJQUVELElBQUksaUJBQWlCLENBQUMsS0FBYTtRQUNsQyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsS0FBSyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxJQUFJLGdCQUFnQjtRQUNuQixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLElBQUksZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUM7SUFDekUsQ0FBQztJQUVELElBQUksZ0JBQWdCLENBQUMsS0FBYTtRQUNqQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO0lBQ2hDLENBQUM7SUFFRCxJQUFJLGFBQWE7UUFDaEIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsSUFBSSxnQkFBZ0IsQ0FBQyxhQUFhLENBQUM7SUFDbkUsQ0FBQztJQUVELElBQUksYUFBYSxDQUFDLEtBQWE7UUFDOUIsSUFBSSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7SUFDN0IsQ0FBQztJQUVELElBQUksZ0JBQWdCOztRQUNuQixPQUFPLE1BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsbUNBQUksZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUM7SUFDekUsQ0FBQztJQUVELElBQUksZ0JBQWdCLENBQUMsS0FBYTtRQUNqQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO0lBQ2hDLENBQUM7SUFDRDs7T0FFRztJQUNILElBQUksZUFBZTtRQUNsQixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxFQUFFO1lBQzNGLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUM7U0FDbEM7UUFDRCxPQUFPLEVBQUUsQ0FBQztJQUNYLENBQUM7SUFFSyxzQkFBc0I7O1lBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFO2dCQUMxQixNQUNDLFNBQVMsR0FBRyxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLDZCQUE2QixDQUFDLHFCQUFxQixFQUFFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUNsSCxHQUFHLEdBQUcsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLGtCQUFrQixDQUFDLGlCQUFpQixDQUFDLENBQUM7Z0JBQ3BGLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUM7Z0JBQ3RDLE1BQU0sSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO2FBQ3RCO1lBRUQsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQztRQUNuQyxDQUFDO0tBQUE7SUFFSyxNQUFNOztZQUNYLE9BQU8sQ0FBQyxHQUFHLENBQUMsK0JBQStCLENBQUMsQ0FBQztZQUM3QyxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNwRCxJQUFJLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7b0JBQ2xFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7aUJBQ25DO2dCQUNELElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO2FBQzFCO1lBRUQsSUFBSSxJQUFJLENBQUMsY0FBYyxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxDQUFDLGlCQUFpQixFQUFFO2dCQUMxRSxJQUFJLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtvQkFDdkcsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDO2lCQUNuRDtnQkFDRCxJQUFJLENBQUMsY0FBYyxHQUFHLFNBQVMsQ0FBQzthQUNoQztZQUVELElBQUksSUFBSSxDQUFDLHFCQUFxQixJQUFJLElBQUksQ0FBQyxxQkFBcUIsS0FBSyxJQUFJLENBQUMsd0JBQXdCLEVBQUU7Z0JBQy9GLElBQUksTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsd0JBQXdCLEVBQUUsSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixDQUFDLEVBQUU7b0JBQ3JILElBQUksQ0FBQyxLQUFLLENBQUMsd0JBQXdCLEdBQUcsSUFBSSxDQUFDLHFCQUFxQixDQUFDO2lCQUNqRTtnQkFDRCxJQUFJLENBQUMscUJBQXFCLEdBQUcsU0FBUyxDQUFDO2FBQ3ZDO1lBRUQsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLElBQUksSUFBSSxDQUFDLGdCQUFnQixLQUFLLElBQUksQ0FBQyxtQkFBbUIsRUFBRTtnQkFDaEYsSUFBSSxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUMsT0FBTyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRTtvQkFDM0csSUFBSSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7aUJBQ3ZEO2dCQUNELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxTQUFTLENBQUM7YUFDbEM7WUFFRCxJQUFJLElBQUksQ0FBQyxrQkFBa0IsSUFBSSxJQUFJLENBQUMsa0JBQWtCLEtBQUssSUFBSSxDQUFDLGlCQUFpQixFQUFFO2dCQUNsRixJQUFJLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFO29CQUMvRyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztpQkFDdkQ7Z0JBRUQsSUFBSSxDQUFDLGtCQUFrQixHQUFHLFNBQVMsQ0FBQzthQUNwQztZQUVELElBQUksSUFBSSxDQUFDLGlCQUFpQixJQUFJLElBQUksQ0FBQyxpQkFBaUIsS0FBSyxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7Z0JBQy9FLElBQUksTUFBTSxJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEVBQUU7b0JBQzdHLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDO2lCQUNyRDtnQkFFRCxJQUFJLENBQUMsaUJBQWlCLEdBQUcsU0FBUyxDQUFDO2FBQ25DO1lBRUQsSUFBSSxJQUFJLENBQUMsY0FBYyxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxDQUFDLGFBQWEsRUFBRTtnQkFDdEUsSUFBSSxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxJQUFJLENBQUMsT0FBTyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsRUFBRTtvQkFDN0csSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQztpQkFDaEQ7Z0JBRUQsSUFBSSxDQUFDLGlCQUFpQixHQUFHLFNBQVMsQ0FBQzthQUNuQztZQUdELElBQUksSUFBSSxDQUFDLGlCQUFpQixJQUFJLElBQUksQ0FBQyxpQkFBaUIsS0FBSyxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7Z0JBQy9FLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDO2dCQUNyRCxJQUFJLENBQUMsaUJBQWlCLEdBQUcsU0FBUyxDQUFDO2FBQ25DO1lBRUQsTUFBTSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFFdEIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsdUNBQXVDO1FBQ3hELENBQUM7S0FBQTtJQU9LLFFBQVE7O1lBQ2IsTUFBTSxJQUFJLEdBQWlCLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUN4RCxJQUFJLElBQUksRUFBRTtnQkFDVCxLQUFLLE1BQU0sWUFBWSxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7b0JBQ3RDLElBQUksWUFBWSxJQUFJLElBQUksRUFBRTt3QkFDekIsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7cUJBQzlDO2lCQUNEO2FBQ0Q7aUJBQU07Z0JBQ04sT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO2dCQUMzQyxNQUFNLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLHFCQUFxQjthQUMzQztRQUNGLENBQUM7S0FBQTtJQUVLLFFBQVE7O1lBQ2IsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekMsQ0FBQztLQUFBO0lBRUssT0FBTzs7WUFDWixNQUNDLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssRUFDdEIsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUM7WUFFcEIsaUJBQWlCO1lBQ2pCLEtBQUssTUFBTSxVQUFVLElBQUk7Z0JBQ3hCLElBQUksQ0FBQyxPQUFPO2dCQUNaLElBQUksQ0FBQyxxQkFBcUI7Z0JBQzFCLElBQUksQ0FBQyxpQkFBaUI7Z0JBQ3RCLElBQUksQ0FBQyx3QkFBd0I7Z0JBQzdCLElBQUksQ0FBQyxtQkFBbUI7YUFDeEIsRUFBRTtnQkFDRixJQUFJLENBQUMsQ0FBQSxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUEsRUFBRTtvQkFDakMsTUFBTSxLQUFLLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2lCQUNyQzthQUNEO1lBRUQseUNBQXlDO1lBQ3pDLEtBQUssTUFBTSxHQUFHLElBQUksU0FBUyxFQUFFO2dCQUM1QixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUMxQyxJQUFJLENBQUMsQ0FBQSxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUEsRUFBRTtvQkFDOUIsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxHQUFHLGFBQWEsR0FBRyxrQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDM0csRUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7aUJBQzlCO2FBQ0Q7WUFFRCxzQ0FBc0M7WUFDdEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1lBQzVDLElBQUksQ0FBQyxDQUFBLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQSxFQUFFO2dCQUNwQyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsYUFBYSxHQUFHLGtCQUFrQixDQUFDLG1CQUFtQixDQUFDLGVBQWUsQ0FBQyxDQUFDO2dCQUN2SCxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxhQUFhLENBQUMsQ0FBQzthQUNwQztZQUVELHdDQUF3QztZQUN4QyxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxDQUFBLE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQSxFQUFFO2dCQUNqQyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsYUFBYSxHQUFHLGtCQUFrQixDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUNwSCxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQzthQUNqQztZQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsK0NBQStDLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDO1FBQzlFLENBQUM7S0FBQTtJQUVELElBQUksaUJBQWlCO1FBQ3BCLE9BQU8sSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ3BELENBQUM7SUFFRCxJQUFJLHdCQUF3QjtRQUMzQixPQUFPLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztJQUMzRCxDQUFDO0lBRUQsSUFBSSxtQkFBbUI7UUFDdEIsT0FBTyxJQUFJLENBQUMsT0FBTyxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUM7SUFDdEQsQ0FBQztJQUVELElBQUkscUJBQXFCO1FBQ3hCLE9BQU8sSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ3BELENBQUM7SUFFRCxJQUFJLGdCQUFnQjtRQUNuQixPQUFPLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7SUFDM0QsQ0FBQztJQUVELElBQUksYUFBYTtRQUNoQixPQUFPLElBQUksQ0FBQyxPQUFPLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO0lBQ3hELENBQUM7SUFFRCxlQUFlLENBQUMsWUFBMkI7UUFDMUMsT0FBTyxJQUFJLENBQUMscUJBQXFCLEdBQUcsR0FBRyxHQUFHLGtCQUFrQixDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ2hHLENBQUM7O0FBclJjLG9DQUFpQixHQUFHLGtpSUFBa2lJLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUUHJvcGVydHlCYWcgfSBmcm9tICcuL0ZlZWRBc3NlbWJsZXInO1xyXG5pbXBvcnQgUlNTVHJhY2tlclBsdWdpbiBmcm9tICcuL21haW4nO1xyXG5pbXBvcnQgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFJTU2ZpbGVNYW5hZ2VyIH0gZnJvbSAnLi9SU1NGaWxlTWFuYWdlcic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElSU1NUcmFja2VyU2V0dGluZ3Mge1xyXG5cdFtrZXk6IHN0cmluZ106IGFueTtcclxuXHRhdXRvVXBkYXRlRmVlZHM6IGJvb2xlYW47XHJcblx0cnNzSG9tZTogc3RyaW5nO1xyXG5cdHJzc0ZlZWRGb2xkZXJOYW1lOiBzdHJpbmc7XHJcblx0cnNzQ29sbGVjdGlvbnNGb2xkZXJOYW1lOiBzdHJpbmc7XHJcblx0cnNzVG9waWNzRm9sZGVyTmFtZTogc3RyaW5nO1xyXG5cdHJzc1RlbXBsYXRlRm9sZGVyOiBzdHJpbmc7XHJcblx0cnNzRGFzaGJvYXJkTmFtZTogc3RyaW5nO1xyXG5cdHJzc1RhZ21hcE5hbWU6IHN0cmluZztcclxuXHRyc3NEZWZhdWx0SW1hZ2U6IHN0cmluZztcclxuXHRkZWZhdWx0SXRlbUxpbWl0OiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IElSU1NUcmFja2VyU2V0dGluZ3MgPSB7XHJcblx0YXV0b1VwZGF0ZUZlZWRzOiBmYWxzZSxcclxuXHRyc3NIb21lOiBcIlJTU1wiLFxyXG5cdHJzc0ZlZWRGb2xkZXJOYW1lOiBcIkZlZWRzXCIsXHJcblx0cnNzQ29sbGVjdGlvbnNGb2xkZXJOYW1lOiBcIkNvbGxlY3Rpb25zXCIsXHJcblx0cnNzVG9waWNzRm9sZGVyTmFtZTogXCJUb3BpY3NcIixcclxuXHRyc3NUZW1wbGF0ZUZvbGRlcjogXCJUZW1wbGF0ZXNcIixcclxuXHRyc3NEYXNoYm9hcmROYW1lOiBcIlJTUyBEYXNoYm9hcmRcIixcclxuXHRyc3NUYWdtYXBOYW1lOiBcIlJTUyBUYWdtYXBcIixcclxuXHRyc3NEZWZhdWx0SW1hZ2U6IFwiXCIsXHJcblx0ZGVmYXVsdEl0ZW1MaW1pdDogMTAwLFxyXG59XHJcblxyXG4vKipcclxuICogVGhlIGJhc2VuYW1lcyBvZiB0ZW1wbGF0ZXMgdXNlZCBmb3IgUlNTIGNvbnRlbnQuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBUVGVtcGxhdGVOYW1lID0gXCJSU1MgRmVlZFwiIHwgXCJSU1MgSXRlbVwiIHwgXCJSU1MgVG9waWNcIiB8IFwiUlNTIENvbGxlY3Rpb25cIiB8IFwiUlNTIERhc2hib2FyZFwiIHwgXCJSU1MgVGFnbWFwXCI7XHJcblxyXG4vKipcclxuICogTGlzdCBvZiBiYXNlbmFtZXMgb2YgdGVtcGxhdGVzIHRvIGJlIGluc3RhbGxlZCBpbnRvIHRoZSBgVGVtcGxhdGVzYCBmb2xkZXIuXHJcbiAqL1xyXG5jb25zdCBURU1QTEFURVM6IFRUZW1wbGF0ZU5hbWVbXSA9IFtcIlJTUyBGZWVkXCIsIFwiUlNTIEl0ZW1cIiwgXCJSU1MgVG9waWNcIiwgXCJSU1MgQ29sbGVjdGlvblwiXTtcclxuXHJcbmV4cG9ydCBjbGFzcyBSU1NUcmFja2VyU2V0dGluZ3MgaW1wbGVtZW50cyBJUlNTVHJhY2tlclNldHRpbmdzIHtcclxuXHRwcml2YXRlIHN0YXRpYyBSU1NfREVGQVVMVF9JTUFHRSA9ICc8c3ZnIGhlaWdodD1cIjMwMHB4XCIgd2lkdGg9XCIzMDBweFwiIHZlcnNpb249XCIxLjFcIiBpZD1cIkNhcGFfMVwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB4bWxuczp4bGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiB2aWV3Qm94PVwiMCAwIDM5OC42NjggMzk4LjY2OFwiIHhtbDpzcGFjZT1cInByZXNlcnZlXCI+IDxnPiA8Zz4gPHBhdGggc3R5bGU9XCJmaWxsOm5vbmU7XCIgZD1cIk05OC4xMDcsMjc1LjQ5OGMtMTMuNzg5LDAtMjUuMDA2LDExLjI2NC0yNS4wMDYsMjUuMTA3YzAsMTMuNzc3LDExLjIxNywyNC45ODYsMjUuMDA2LDI0Ljk4NiBjMTMuODM0LDAsMjUuMDktMTEuMjA5LDI1LjA5LTI0Ljk4NkMxMjMuMTk3LDI4Ni43NjIsMTExLjk0MSwyNzUuNDk4LDk4LjEwNywyNzUuNDk4elwiLz4gPHBhdGggc3R5bGU9XCJmaWxsOm5vbmU7XCIgZD1cIk0zNjAuMDU3LDI0SDM4LjYxM0MzMC41NTUsMjQsMjQsMzAuNTU3LDI0LDM4LjYxM3YzMjEuNDQzYzAsOC4wNTcsNi41NTUsMTQuNjExLDE0LjYxMywxNC42MTEgaDMyMS40NDNjOC4wNTcsMCwxNC42MTEtNi41NTUsMTQuNjExLTE0LjYxMVYzOC42MTNDMzc0LjY2OCwzMC41NTcsMzY4LjExMywyNCwzNjAuMDU3LDI0eiBNOTguMTA3LDM0OS41OTIgYy0yNy4wMjEsMC00OS4wMDYtMjEuOTc1LTQ5LjAwNi00OC45ODZjMC0yNy4wNzgsMjEuOTg0LTQ5LjEwNyw0OS4wMDYtNDkuMTA3YzI3LjA2OCwwLDQ5LjA5LDIyLjAyOSw0OS4wOSw0OS4xMDcgQzE0Ny4xOTcsMzI3LjYxNywxMjUuMTc2LDM0OS41OTIsOTguMTA3LDM0OS41OTJ6IE0yNDIuNzE1LDM0Ny41MTZjMCwwLTAuMDA4LDAuMDAyLTAuMDE2LDBoLTQ4LjcyOSBjLTYuNTQxLDAtMTEuODc3LTUuMjM4LTExLjk5OC0xMS43NzdjLTAuNTg0LTMxLjYyNS0xMy4xNjQtNjEuMzE2LTM1LjQyNC04My42MDRjLTIyLjI3NS0yMi4zMzgtNTEuODQ2LTM0Ljk1My04My4yNy0zNS41MjcgYy02LjU0MS0wLjExOS0xMS43ODEtNS40NTctMTEuNzgxLTExLjk5OHYtNDguNTgyYzAtMy4yMTEsMS4yODctNi4yODcsMy41NzItOC41NDNjMi4yNDgtMi4yMTcsNS4yNzUtMy40NTcsOC40MjgtMy40NTcgYzAuMDU1LDAsMC4xMDcsMCwwLjE2MiwwYzUwLjY1NCwwLjY4Niw5OC4zMzgsMjAuODgzLDEzNC4yNzEsNTYuODczYzM1Ljc1OCwzNS44MTQsNTUuODk2LDgzLjI4MSw1Ni43NTYsMTMzLjczMiBjMC4wMjEsMC4yOTEsMC4wMzEsMC41ODYsMC4wMzEsMC44ODNDMjU0LjcxOSwzNDIuMTQzLDI0OS4zNDgsMzQ3LjUxNiwyNDIuNzE1LDM0Ny41MTZ6IE0zMzcuNTgyLDM0Ny41MTYgYzAsMC0wLjAwOCwwLjAwMi0wLjAxNiwwaC00OC42NDhjLTYuNTc4LDAtMTEuOTMtNS4yOTUtMTItMTEuODcxYy0xLjI1NC0xMTYuNzM4LTk3LjAwOC0yMTIuNzQtMjEzLjQ1MS0yMTQuMDAyIGMtNi41NzYtMC4wNzItMTEuODcxLTUuNDI0LTExLjg3MS0xMlY2MS4wNzhjMC0zLjIwMSwxLjI3OS02LjI2OSwzLjU1My04LjUyMWMyLjI3My0yLjI1NCw1LjM2Ny0zLjUxMiw4LjU1NS0zLjQ3NyBjNzUuOTUxLDAuNjgsMTQ3LjQ0MSwzMC43NjgsMjAxLjMwMyw4NC43MjNjNTMuNjg5LDUzLjc3OSw4My42OTksMTI1LjA5Niw4NC41NTMsMjAwLjg5MWMwLjAyLDAuMjcyLDAuMDI5LDAuNTQ3LDAuMDI5LDAuODIyIEMzNDkuNTg4LDM0Mi4xNDMsMzQ0LjIxNSwzNDcuNTE2LDMzNy41ODIsMzQ3LjUxNnpcIi8+IDxwYXRoIHN0eWxlPVwiZmlsbDojM0Q2ODg5O1wiIGQ9XCJNOTguMTA3LDI1MS40OThjLTI3LjAyMSwwLTQ5LjAwNiwyMi4wMjktNDkuMDA2LDQ5LjEwN2MwLDI3LjAxMiwyMS45ODQsNDguOTg2LDQ5LjAwNiw0OC45ODYgYzI3LjA2OCwwLDQ5LjA5LTIxLjk3NSw0OS4wOS00OC45ODZDMTQ3LjE5NywyNzMuNTI3LDEyNS4xNzYsMjUxLjQ5OCw5OC4xMDcsMjUxLjQ5OHogTTk4LjEwNywzMjUuNTkyIGMtMTMuNzg5LDAtMjUuMDA2LTExLjIwOS0yNS4wMDYtMjQuOTg2YzAtMTMuODQ0LDExLjIxNy0yNS4xMDcsMjUuMDA2LTI1LjEwN2MxMy44MzQsMCwyNS4wOSwxMS4yNjQsMjUuMDksMjUuMTA3IEMxMjMuMTk3LDMxNC4zODMsMTExLjk0MSwzMjUuNTkyLDk4LjEwNywzMjUuNTkyelwiLz4gPHBhdGggc3R5bGU9XCJmaWxsOiM3M0QwRjQ7XCIgZD1cIk03NS40OTgsMTY4LjYzM3YyNC42NjhjMzMuMjQ0LDMuMzAxLDY0LjE1LDE3LjkyNiw4OC4wMzcsNDEuODgxIGMyMy44NzksMjMuOTA2LDM4LjQ1OSw1NC45MjIsNDEuNzQ2LDg4LjMzNGgyNC44MTZDMjIzLjA2NiwyNDEuODkzLDE1Ni45ODYsMTc1LjY4OSw3NS40OTgsMTY4LjYzM3pcIi8+IDxwYXRoIHN0eWxlPVwiZmlsbDojM0Q2ODg5O1wiIGQ9XCJNMTk3LjkzMiwyMDAuOWMtMzUuOTM0LTM1Ljk5LTgzLjYxNy01Ni4xODgtMTM0LjI3MS01Ni44NzNjLTAuMDU1LDAtMC4xMDcsMC0wLjE2MiwwIGMtMy4xNTIsMC02LjE4LDEuMjQtOC40MjgsMy40NTdjLTIuMjg1LDIuMjU2LTMuNTcyLDUuMzMyLTMuNTcyLDguNTQzdjQ4LjU4MmMwLDYuNTQxLDUuMjQsMTEuODc5LDExLjc4MSwxMS45OTggYzMxLjQyNCwwLjU3NCw2MC45OTQsMTMuMTg5LDgzLjI3LDM1LjUyN2MyMi4yNiwyMi4yODcsMzQuODQsNTEuOTc5LDM1LjQyNCw4My42MDRjMC4xMjEsNi41MzksNS40NTcsMTEuNzc3LDExLjk5OCwxMS43NzcgaDQ4LjcyOWMwLjAwOCwwLjAwMiwwLjAxNiwwLDAuMDE2LDBjNi42MzMsMCwxMi4wMDQtNS4zNzMsMTIuMDA0LTEyYzAtMC4yOTctMC4wMS0wLjU5Mi0wLjAzMS0wLjg4MyBDMjUzLjgyOCwyODQuMTgyLDIzMy42ODksMjM2LjcxNSwxOTcuOTMyLDIwMC45eiBNMjA1LjI4MSwzMjMuNTE2Yy0zLjI4Ny0zMy40MTItMTcuODY3LTY0LjQyOC00MS43NDYtODguMzM0IGMtMjMuODg3LTIzLjk1NS01NC43OTMtMzguNTgtODguMDM3LTQxLjg4MXYtMjQuNjY4YzgxLjQ4OCw3LjA1NywxNDcuNTY4LDczLjI2LDE1NC42LDE1NC44ODNIMjA1LjI4MXpcIi8+IDxwYXRoIHN0eWxlPVwiZmlsbDojNzNEMEY0O1wiIGQ9XCJNNzUuNTk2LDczLjQ2NXYyNC41OThjNTguNTE2LDMuNTAyLDExMy4xODgsMjguMTIxLDE1NS4wMjksNzAuMDY0IGM0MS44MzgsNDEuOTQzLDY2LjM5MSw5Ni43NDIsNjkuODc3LDE1NS4zODloMjQuNjgyQzMxNy44NTIsMTg5LjU5LDIwOS4yOTMsODAuODM0LDc1LjU5Niw3My40NjV6XCIvPiA8cGF0aCBzdHlsZT1cImZpbGw6IzNENjg4OTtcIiBkPVwiTTI2NS4wMDYsMTMzLjgwM0MyMTEuMTQ1LDc5Ljg0OCwxMzkuNjU0LDQ5Ljc2LDYzLjcwMyw0OS4wOGMtMy4xODgtMC4wMzUtNi4yODEsMS4yMjMtOC41NTUsMy40NzcgYy0yLjI3MywyLjI1Mi0zLjU1Myw1LjMyLTMuNTUzLDguNTIxdjQ4LjU2NWMwLDYuNTc2LDUuMjk1LDExLjkyOCwxMS44NzEsMTJjMTE2LjQ0MywxLjI2MiwyMTIuMTk3LDk3LjI2NCwyMTMuNDUxLDIxNC4wMDIgYzAuMDcsNi41NzYsNS40MjIsMTEuODcxLDEyLDExLjg3MWg0OC42NDhjMC4wMDgsMC4wMDIsMC4wMTYsMCwwLjAxNiwwYzYuNjMzLDAsMTIuMDA2LTUuMzczLDEyLjAwNi0xMiBjMC0wLjI3NS0wLjAxLTAuNTUxLTAuMDI5LTAuODIyQzM0OC43MDUsMjU4Ljg5OCwzMTguNjk1LDE4Ny41ODIsMjY1LjAwNiwxMzMuODAzeiBNMzAwLjUwMiwzMjMuNTE2IGMtMy40ODYtNTguNjQ2LTI4LjAzOS0xMTMuNDQ1LTY5Ljg3Ny0xNTUuMzg5Yy00MS44NDItNDEuOTQzLTk2LjUxNC02Ni41NjMtMTU1LjAyOS03MC4wNjRWNzMuNDY1IGMxMzMuNjk3LDcuMzY5LDI0Mi4yNTYsMTE2LjEyNSwyNDkuNTg4LDI1MC4wNTFIMzAwLjUwMnpcIi8+IDxwYXRoIHN0eWxlPVwiZmlsbDojM0Q2ODg5O1wiIGQ9XCJNMzYwLjA1NywwSDM4LjYxM0MxNy4zMjIsMCwwLDE3LjMyMiwwLDM4LjYxM3YzMjEuNDQzYzAsMjEuMjkxLDE3LjMyMiwzOC42MTEsMzguNjEzLDM4LjYxMSBoMzIxLjQ0M2MyMS4yOTEsMCwzOC42MTEtMTcuMzIsMzguNjExLTM4LjYxMVYzOC42MTNDMzk4LjY2OCwxNy4zMjIsMzgxLjM0OCwwLDM2MC4wNTcsMHogTTM3NC42NjgsMzYwLjA1NyBjMCw4LjA1Ny02LjU1NSwxNC42MTEtMTQuNjExLDE0LjYxMUgzOC42MTNjLTguMDU5LDAtMTQuNjEzLTYuNTU1LTE0LjYxMy0xNC42MTFWMzguNjEzQzI0LDMwLjU1NywzMC41NTUsMjQsMzguNjEzLDI0aDMyMS40NDMgYzguMDU3LDAsMTQuNjExLDYuNTU3LDE0LjYxMSwxNC42MTNWMzYwLjA1N3pcIi8+IDwvZz4gPC9nPiA8L3N2Zz4nO1xyXG5cdHBsdWdpbjogUlNTVHJhY2tlclBsdWdpbjtcclxuXHRhcHA6IEFwcDtcclxuXHJcblx0cHJpdmF0ZSBnZXQgX2ZpbGVtZ3IoKTogUlNTZmlsZU1hbmFnZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMucGx1Z2luLmZpbGVtZ3I7XHJcblx0fTtcclxuXHJcblx0c3RhdGljIGdldFRlbXBsYXRlRmlsZW5hbWUodGVtcGxhdGVOYW1lOiBUVGVtcGxhdGVOYW1lKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0ZW1wbGF0ZU5hbWUgKyBcIi5tZFwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVGhlIHBlcnNpc3RlZCBzZXR0aW5ncyBzZXR0aW5nc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgX2RhdGE6IElSU1NUcmFja2VyU2V0dGluZ3MgPSB7IC4uLkRFRkFVTFRfU0VUVElOR1MgfTtcclxuXHJcblx0Z2V0IGF1dG9VcGRhdGVGZWVkcygpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLmF1dG9VcGRhdGVGZWVkcztcclxuXHR9XHJcblxyXG5cdHNldCBhdXRvVXBkYXRlRmVlZHModmFsdWU6IGJvb2xlYW4pIHtcclxuXHRcdHRoaXMuX2RhdGEuYXV0b1VwZGF0ZUZlZWRzID0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIF9yc3NIb21lPzogc3RyaW5nO1xyXG5cdHByaXZhdGUgX3Jzc0ZlZWRGb2xkZXI/OiBzdHJpbmc7XHJcblx0cHJpdmF0ZSBfcnNzQ29sbGVjdGlvbnNGb2xkZXI/OiBzdHJpbmc7XHJcblx0cHJpdmF0ZSBfcnNzVG9waWNzRm9sZGVyPzogc3RyaW5nO1xyXG5cdHByaXZhdGUgX3Jzc1RlbXBsYXRlRm9sZGVyPzogc3RyaW5nO1xyXG5cdHByaXZhdGUgX3Jzc0Rhc2hib2FyZE5hbWU/OiBzdHJpbmc7XHJcblx0cHJpdmF0ZSBfcnNzVGFnbWFwTmFtZT86IHN0cmluZztcclxuXHRwcml2YXRlIF9kZWZhdWx0SXRlbUxpbWl0PzogbnVtYmVyO1xyXG5cclxuXHRnZXQgcnNzSG9tZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RhdGEucnNzSG9tZSA/PyBERUZBVUxUX1NFVFRJTkdTLnJzc0hvbWU7XHJcblx0fVxyXG5cclxuXHRzZXQgcnNzSG9tZSh2YWx1ZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLl9yc3NIb21lID0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXQgcnNzRmVlZEZvbGRlck5hbWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLnJzc0ZlZWRGb2xkZXJOYW1lID8/IERFRkFVTFRfU0VUVElOR1MucnNzRmVlZEZvbGRlck5hbWU7XHJcblx0fVxyXG5cclxuXHRzZXQgcnNzRmVlZEZvbGRlck5hbWUodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5fcnNzRmVlZEZvbGRlciA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0IHJzc0NvbGxlY3Rpb25zRm9sZGVyTmFtZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RhdGEucnNzQ29sbGVjdGlvbnNGb2xkZXJOYW1lID8/IERFRkFVTFRfU0VUVElOR1MucnNzQ29sbGVjdGlvbnNGb2xkZXJOYW1lO1xyXG5cdH1cclxuXHJcblx0c2V0IHJzc0NvbGxlY3Rpb25zRm9sZGVyTmFtZSh2YWx1ZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLl9yc3NDb2xsZWN0aW9uc0ZvbGRlciA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0IHJzc1RvcGljc0ZvbGRlck5hbWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLnJzc1RvcGljc0ZvbGRlck5hbWUgPz8gREVGQVVMVF9TRVRUSU5HUy5yc3NUb3BpY3NGb2xkZXJOYW1lO1xyXG5cdH1cclxuXHJcblx0c2V0IHJzc1RvcGljc0ZvbGRlck5hbWUodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5fcnNzQ29sbGVjdGlvbnNGb2xkZXIgPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGdldCByc3NUZW1wbGF0ZUZvbGRlcigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RhdGEucnNzVGVtcGxhdGVGb2xkZXIgPz8gREVGQVVMVF9TRVRUSU5HUy5yc3NUZW1wbGF0ZUZvbGRlcjtcclxuXHR9XHJcblxyXG5cdHNldCByc3NUZW1wbGF0ZUZvbGRlcih2YWx1ZTogc3RyaW5nKSB7XHJcblx0XHR0aGlzLl9yc3NUZW1wbGF0ZUZvbGRlciA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0IHJzc0Rhc2hib2FyZE5hbWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLnJzc0Rhc2hib2FyZE5hbWUgfHwgREVGQVVMVF9TRVRUSU5HUy5yc3NEYXNoYm9hcmROYW1lO1xyXG5cdH1cclxuXHJcblx0c2V0IHJzc0Rhc2hib2FyZE5hbWUodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5fcnNzRGFzaGJvYXJkTmFtZSA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0IHJzc1RhZ21hcE5hbWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLnJzc1RhZ21hcE5hbWUgfHwgREVGQVVMVF9TRVRUSU5HUy5yc3NUYWdtYXBOYW1lO1xyXG5cdH1cclxuXHJcblx0c2V0IHJzc1RhZ21hcE5hbWUodmFsdWU6IHN0cmluZykge1xyXG5cdFx0dGhpcy5fcnNzVGFnbWFwTmFtZSA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0IGRlZmF1bHRJdGVtTGltaXQoKTpudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RhdGEuZGVmYXVsdEl0ZW1MaW1pdCA/PyBERUZBVUxUX1NFVFRJTkdTLmRlZmF1bHRJdGVtTGltaXQ7XHJcblx0fVxyXG5cclxuXHRzZXQgZGVmYXVsdEl0ZW1MaW1pdCh2YWx1ZTogbnVtYmVyKSB7XHJcblx0XHR0aGlzLl9kZWZhdWx0SXRlbUxpbWl0ID0gdmFsdWU7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEdldCB0aGUgcGF0aCB0byB0aGUgUlNTIGRlZmF1bHQgaW1hZ2VcclxuXHQgKi9cclxuXHRnZXQgcnNzRGVmYXVsdEltYWdlKCk6IHN0cmluZyB7XHJcblx0XHRpZiAodGhpcy5fZGF0YS5yc3NEZWZhdWx0SW1hZ2UgJiYgdGhpcy5hcHAudmF1bHQuZ2V0RmlsZUJ5UGF0aCh0aGlzLl9kYXRhLnJzc0RlZmF1bHRJbWFnZSkpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2RhdGEucnNzRGVmYXVsdEltYWdlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFwiXCI7XHJcblx0fVxyXG5cclxuXHRhc3luYyBnZXRSc3NEZWZhdWx0SW1hZ2VQYXRoKCk6IFByb21pc2U8c3RyaW5nPiB7XHJcblx0XHRpZiAoIXRoaXMucnNzRGVmYXVsdEltYWdlKSB7XHJcblx0XHRcdGNvbnN0XHJcblx0XHRcdFx0aW1hZ2VQYXRoID0gYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIuZ2V0QXZhaWxhYmxlUGF0aEZvckF0dGFjaG1lbnQoXCJSU1NkZWZhdWx0SW1hZ2Uuc3ZnXCIsIHRoaXMucnNzRGFzaGJvYXJkUGF0aCksXHJcblx0XHRcdFx0aW1nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGltYWdlUGF0aCwgUlNTVHJhY2tlclNldHRpbmdzLlJTU19ERUZBVUxUX0lNQUdFKTtcclxuXHRcdFx0dGhpcy5fZGF0YS5yc3NEZWZhdWx0SW1hZ2UgPSBpbWcucGF0aDtcclxuXHRcdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLl9kYXRhLnJzc0RlZmF1bHRJbWFnZTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIGNvbW1pdCgpIHtcclxuXHRcdGNvbnNvbGUubG9nKFwiQ29tbWl0aW5nIGNoYW5nZXMgaW4gc2V0dGluZ3NcIik7XHJcblx0XHRpZiAodGhpcy5fcnNzSG9tZSAmJiB0aGlzLl9yc3NIb21lICE9PSB0aGlzLnJzc0hvbWUpIHtcclxuXHRcdFx0aWYgKGF3YWl0IHRoaXMuX2ZpbGVtZ3IucmVuYW1lRm9sZGVyKHRoaXMucnNzSG9tZSwgdGhpcy5fcnNzSG9tZSkpIHtcclxuXHRcdFx0XHR0aGlzLl9kYXRhLnJzc0hvbWUgPSB0aGlzLl9yc3NIb21lO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX3Jzc0hvbWUgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jzc0ZlZWRGb2xkZXIgJiYgdGhpcy5fcnNzRmVlZEZvbGRlciAhPT0gdGhpcy5yc3NGZWVkRm9sZGVyTmFtZSkge1xyXG5cdFx0XHRpZiAoYXdhaXQgdGhpcy5fZmlsZW1nci5yZW5hbWVGb2xkZXIodGhpcy5yc3NGZWVkRm9sZGVyUGF0aCwgdGhpcy5yc3NIb21lICsgXCIvXCIgKyB0aGlzLl9yc3NGZWVkRm9sZGVyKSkge1xyXG5cdFx0XHRcdHRoaXMuX2RhdGEucnNzRmVlZEZvbGRlck5hbWUgPSB0aGlzLl9yc3NGZWVkRm9sZGVyO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX3Jzc0ZlZWRGb2xkZXIgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jzc0NvbGxlY3Rpb25zRm9sZGVyICYmIHRoaXMuX3Jzc0NvbGxlY3Rpb25zRm9sZGVyICE9PSB0aGlzLnJzc0NvbGxlY3Rpb25zRm9sZGVyTmFtZSkge1xyXG5cdFx0XHRpZiAoYXdhaXQgdGhpcy5fZmlsZW1nci5yZW5hbWVGb2xkZXIodGhpcy5yc3NDb2xsZWN0aW9uc0ZvbGRlclBhdGgsIHRoaXMucnNzSG9tZSArIFwiL1wiICsgdGhpcy5fcnNzQ29sbGVjdGlvbnNGb2xkZXIpKSB7XHJcblx0XHRcdFx0dGhpcy5fZGF0YS5yc3NDb2xsZWN0aW9uc0ZvbGRlck5hbWUgPSB0aGlzLl9yc3NDb2xsZWN0aW9uc0ZvbGRlcjtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9yc3NDb2xsZWN0aW9uc0ZvbGRlciA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fcnNzVG9waWNzRm9sZGVyICYmIHRoaXMuX3Jzc1RvcGljc0ZvbGRlciAhPT0gdGhpcy5yc3NUb3BpY3NGb2xkZXJOYW1lKSB7XHJcblx0XHRcdGlmIChhd2FpdCB0aGlzLl9maWxlbWdyLnJlbmFtZUZvbGRlcih0aGlzLnJzc1RvcGljc0ZvbGRlclBhdGgsIHRoaXMucnNzSG9tZSArIFwiL1wiICsgdGhpcy5fcnNzVG9waWNzRm9sZGVyKSkge1xyXG5cdFx0XHRcdHRoaXMuX2RhdGEucnNzVG9waWNzRm9sZGVyTmFtZSA9IHRoaXMuX3Jzc1RvcGljc0ZvbGRlcjtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9yc3NUb3BpY3NGb2xkZXIgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jzc1RlbXBsYXRlRm9sZGVyICYmIHRoaXMuX3Jzc1RlbXBsYXRlRm9sZGVyICE9PSB0aGlzLnJzc1RlbXBsYXRlRm9sZGVyKSB7XHJcblx0XHRcdGlmIChhd2FpdCB0aGlzLl9maWxlbWdyLnJlbmFtZUZvbGRlcih0aGlzLnJzc1RlbXBsYXRlRm9sZGVyUGF0aCwgdGhpcy5yc3NIb21lICsgXCIvXCIgKyB0aGlzLl9yc3NUZW1wbGF0ZUZvbGRlcikpIHtcclxuXHRcdFx0XHR0aGlzLl9kYXRhLnJzc1RlbXBsYXRlRm9sZGVyID0gdGhpcy5fcnNzVGVtcGxhdGVGb2xkZXI7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuX3Jzc1RlbXBsYXRlRm9sZGVyID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLl9yc3NEYXNoYm9hcmROYW1lICYmIHRoaXMuX3Jzc0Rhc2hib2FyZE5hbWUgIT09IHRoaXMucnNzRGFzaGJvYXJkTmFtZSkge1xyXG5cdFx0XHRpZiAoYXdhaXQgdGhpcy5fZmlsZW1nci5yZW5hbWVGaWxlKHRoaXMucnNzVGVtcGxhdGVGb2xkZXJQYXRoLCB0aGlzLnJzc0hvbWUgKyBcIi9cIiArIHRoaXMuX3Jzc1RlbXBsYXRlRm9sZGVyKSkge1xyXG5cdFx0XHRcdHRoaXMuX2RhdGEucnNzRGFzaGJvYXJkTmFtZSA9IHRoaXMuX3Jzc0Rhc2hib2FyZE5hbWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuX3Jzc0Rhc2hib2FyZE5hbWUgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jzc1RhZ21hcE5hbWUgJiYgdGhpcy5fcnNzVGFnbWFwTmFtZSAhPT0gdGhpcy5yc3NUYWdtYXBOYW1lKSB7XHJcblx0XHRcdGlmIChhd2FpdCB0aGlzLl9maWxlbWdyLnJlbmFtZUZpbGUodGhpcy5yc3NUZW1wbGF0ZUZvbGRlclBhdGgsIHRoaXMucnNzSG9tZSArIFwiL1wiICsgdGhpcy5fcnNzVGVtcGxhdGVGb2xkZXIpKSB7XHJcblx0XHRcdFx0dGhpcy5fZGF0YS5fcnNzVGFnbWFwTmFtZSA9IHRoaXMuX3Jzc1RhZ21hcE5hbWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuX3Jzc0Rhc2hib2FyZE5hbWUgPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdGlmICh0aGlzLl9kZWZhdWx0SXRlbUxpbWl0ICYmIHRoaXMuX2RlZmF1bHRJdGVtTGltaXQgIT09IHRoaXMuZGVmYXVsdEl0ZW1MaW1pdCkge1xyXG5cdFx0XHR0aGlzLl9kYXRhLmRlZmF1bHRJdGVtTGltaXQgPSB0aGlzLl9kZWZhdWx0SXRlbUxpbWl0O1xyXG5cdFx0XHR0aGlzLl9kZWZhdWx0SXRlbUxpbWl0ID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEoKTtcclxuXHJcblx0XHR0aGlzLmluc3RhbGwoKTsgLy8gYWx3YXlzIGFzc3VyZSBpbnRlZ3JpdHkgYWZ0ZXIgY29tbWl0XHJcblx0fVxyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBSU1NUcmFja2VyUGx1Z2luKSB7XHJcblx0XHR0aGlzLmFwcCA9IGFwcDtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgbG9hZERhdGEoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCBkYXRhOiBUUHJvcGVydHlCYWcgPSBhd2FpdCB0aGlzLnBsdWdpbi5sb2FkRGF0YSgpO1xyXG5cdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0Zm9yIChjb25zdCBwcm9wZXJ0eU5hbWUgaW4gdGhpcy5fZGF0YSkge1xyXG5cdFx0XHRcdGlmIChwcm9wZXJ0eU5hbWUgaW4gZGF0YSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fZGF0YVtwcm9wZXJ0eU5hbWVdID0gZGF0YVtwcm9wZXJ0eU5hbWVdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Y29uc29sZS5sb2coXCJyc3MtdHJhY2tlciBmaXJzdCB0aW1lIGxvYWRcIik7XHJcblx0XHRcdGF3YWl0IHRoaXMuaW5zdGFsbCgpOyAvLyBmaXJzdCB0aW1lIGluc3RhbGxcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG5cdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMuX2RhdGEpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgaW5zdGFsbCgpIHtcclxuXHRcdGNvbnN0XHJcblx0XHRcdHZhdWx0ID0gdGhpcy5hcHAudmF1bHQsXHJcblx0XHRcdGZzID0gdmF1bHQuYWRhcHRlcjtcclxuXHJcblx0XHQvLyBjcmVhdGUgZm9sZGVyc1xyXG5cdFx0Zm9yIChjb25zdCBmb2xkZXJQYXRoIG9mIFtcclxuXHRcdFx0dGhpcy5yc3NIb21lLFxyXG5cdFx0XHR0aGlzLnJzc1RlbXBsYXRlRm9sZGVyUGF0aCxcclxuXHRcdFx0dGhpcy5yc3NGZWVkRm9sZGVyUGF0aCxcclxuXHRcdFx0dGhpcy5yc3NDb2xsZWN0aW9uc0ZvbGRlclBhdGgsXHJcblx0XHRcdHRoaXMucnNzVG9waWNzRm9sZGVyUGF0aCxcclxuXHRcdF0pIHtcclxuXHRcdFx0aWYgKCFhd2FpdCBmcy5leGlzdHMoZm9sZGVyUGF0aCkpIHtcclxuXHRcdFx0XHRhd2FpdCB2YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBpbnN0YWxsIGZhY3RvcnkgdGVtcGxhdGVzIGlmIG5lY2Vzc2FyeVxyXG5cdFx0Zm9yIChjb25zdCB0cGwgb2YgVEVNUExBVEVTKSB7XHJcblx0XHRcdGNvbnN0IHRwbFBhdGggPSB0aGlzLmdldFRlbXBsYXRlUGF0aCh0cGwpO1xyXG5cdFx0XHRpZiAoIWF3YWl0IGZzLmV4aXN0cyh0cGxQYXRoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGZhY3RvcnlQYXRoID0gdGhpcy5wbHVnaW4ubWFuaWZlc3QuZGlyICsgXCIvVGVtcGxhdGVzL1wiICsgUlNTVHJhY2tlclNldHRpbmdzLmdldFRlbXBsYXRlRmlsZW5hbWUodHBsKTtcclxuXHRcdFx0XHRmcy5jb3B5KGZhY3RvcnlQYXRoLCB0cGxQYXRoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHRoZSBSU1MgZGFzaGJvYXJkIGlzIGEgc3BlY2lhbCBjYXNlXHJcblx0XHRjb25zdCBkYXNoYm9hcmRQYXRoID0gdGhpcy5yc3NEYXNoYm9hcmRQYXRoO1xyXG5cdFx0aWYgKCFhd2FpdCBmcy5leGlzdHMoZGFzaGJvYXJkUGF0aCkpIHtcclxuXHRcdFx0Y29uc3QgZmFjdG9yeVBhdGggPSB0aGlzLnBsdWdpbi5tYW5pZmVzdC5kaXIgKyBcIi9UZW1wbGF0ZXMvXCIgKyBSU1NUcmFja2VyU2V0dGluZ3MuZ2V0VGVtcGxhdGVGaWxlbmFtZShcIlJTUyBEYXNoYm9hcmRcIik7XHJcblx0XHRcdGZzLmNvcHkoZmFjdG9yeVBhdGgsIGRhc2hib2FyZFBhdGgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIHRoZSBSU1MgdGFnIG1hcCBpcyBhIHNwZWNpYWwgY2FzZSB0b29cclxuXHRcdGNvbnN0IHRhZ21hcFBhdGggPSB0aGlzLnJzc1RhZ21hcFBhdGg7XHJcblx0XHRpZiAoIWF3YWl0IGZzLmV4aXN0cyh0YWdtYXBQYXRoKSkge1xyXG5cdFx0XHRjb25zdCBmYWN0b3J5UGF0aCA9IHRoaXMucGx1Z2luLm1hbmlmZXN0LmRpciArIFwiL1RlbXBsYXRlcy9cIiArIFJTU1RyYWNrZXJTZXR0aW5ncy5nZXRUZW1wbGF0ZUZpbGVuYW1lKFwiUlNTIFRhZ21hcFwiKTtcclxuXHRcdFx0ZnMuY29weShmYWN0b3J5UGF0aCwgdGFnbWFwUGF0aCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc29sZS5sb2coYFJTUyBkaXJlY3Rvcnkgc3RydWN0dXJlIGNyZWF0ZWQvdXBkYXRlZCBhdCAnJHt0aGlzLnJzc0hvbWV9Jy5gKTtcclxuXHR9XHJcblxyXG5cdGdldCByc3NGZWVkRm9sZGVyUGF0aCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMucnNzSG9tZSArIFwiL1wiICsgdGhpcy5yc3NGZWVkRm9sZGVyTmFtZTtcclxuXHR9XHJcblxyXG5cdGdldCByc3NDb2xsZWN0aW9uc0ZvbGRlclBhdGgoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnJzc0hvbWUgKyBcIi9cIiArIHRoaXMucnNzQ29sbGVjdGlvbnNGb2xkZXJOYW1lO1xyXG5cdH1cclxuXHJcblx0Z2V0IHJzc1RvcGljc0ZvbGRlclBhdGgoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnJzc0hvbWUgKyBcIi9cIiArIHRoaXMucnNzVG9waWNzRm9sZGVyTmFtZTtcclxuXHR9XHJcblxyXG5cdGdldCByc3NUZW1wbGF0ZUZvbGRlclBhdGgoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnJzc0hvbWUgKyBcIi9cIiArIHRoaXMucnNzVGVtcGxhdGVGb2xkZXI7XHJcblx0fVxyXG5cclxuXHRnZXQgcnNzRGFzaGJvYXJkUGF0aCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMucnNzSG9tZSArIFwiL1wiICsgdGhpcy5yc3NEYXNoYm9hcmROYW1lICsgXCIubWRcIjtcclxuXHR9XHJcblxyXG5cdGdldCByc3NUYWdtYXBQYXRoKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5yc3NIb21lICsgXCIvXCIgKyB0aGlzLnJzc1RhZ21hcE5hbWUgKyBcIi5tZFwiO1xyXG5cdH1cclxuXHJcblx0Z2V0VGVtcGxhdGVQYXRoKHRlbXBsYXRlTmFtZTogVFRlbXBsYXRlTmFtZSk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5yc3NUZW1wbGF0ZUZvbGRlclBhdGggKyBcIi9cIiArIFJTU1RyYWNrZXJTZXR0aW5ncy5nZXRUZW1wbGF0ZUZpbGVuYW1lKHRlbXBsYXRlTmFtZSk7XHJcblx0fVxyXG59XHJcbiJdfQ==